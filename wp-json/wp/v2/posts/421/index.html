{"id":421,"date":"2023-01-09T11:42:56","date_gmt":"2023-01-09T11:42:56","guid":{"rendered":"https:\/\/devopsinsiders.vehicleaider.com\/?p=421"},"modified":"2023-01-09T12:05:34","modified_gmt":"2023-01-09T12:05:34","slug":"static-code-analysis-with-sonarcloud-and-azure-pipelines","status":"publish","type":"post","link":"http:\/\/localhost\/devopsinsiders\/static-code-analysis-with-sonarcloud-and-azure-pipelines\/","title":{"rendered":"Static Code Analysis with SonarCloud and Azure Pipelines."},"content":{"rendered":"\n<figure class=\"wp-block-image size-full\"><img decoding=\"async\" loading=\"lazy\" width=\"700\" height=\"300\" src=\"https:\/\/devopsinsiders.vehicleaider.com\/wp-content\/uploads\/2023\/01\/word-image-421-1.jpeg\" alt=\"\" class=\"wp-image-422\"\/><\/figure>\n\n\n\n<p>After setting up a CI Pipeline in the last blog, we are back with a new Blog. In the blog, I will tell you how you scan your code using SonarCloud for Free!<\/p>\n\n\n\n<p>Please read the previous blog for setting up a CI pipeline using Azure Pipelines:&nbsp;<\/p>\n\n\n\n<p>For this tutorial, we will use the following Git Repositories and setup CICD for a Quiz App made in React JS.<\/p>\n\n\n\n<p><strong>Link:<\/strong>&nbsp;<a href=\"https:\/\/github.com\/27aadesh\/QuizApp.git\" target=\"_blank\" rel=\"noopener\">https:\/\/github.com\/27aadesh\/QuizApp.git<\/a><\/p>\n\n\n\n<p>So, Let\u2019s begin.<\/p>\n\n\n\n<h1 class=\"wp-block-heading\"><strong><strong>Static Code Analysis<\/strong><\/strong><\/h1>\n\n\n\n<p>Static program analysis is the analysis of computer software that is performed without actually executing programs, in contrast with dynamic analysis, which is the analysis performed on programs while they are executing.<\/p>\n\n\n\n<h1 class=\"wp-block-heading\">SonarCloud<\/h1>\n\n\n\n<p>Sonarcloud is a Cloud version of SonarQube with all the features and the main thing is that \u201cIt\u2019s Free for public projects\u201d.<\/p>\n\n\n\n<p>When we use Sonarcloud, We are free from managing the Sonarqube machine, Database, and version upgrades. Everything is done automatically and we can use it as a Software as a Service.<\/p>\n\n\n\n<p>Also, We get a cool badge which we can show in our README.MD file.<\/p>\n\n\n\n<figure class=\"wp-block-image\"><img decoding=\"async\" loading=\"lazy\" width=\"513\" height=\"278\" src=\"https:\/\/devopsinsiders.vehicleaider.com\/wp-content\/uploads\/2023\/01\/word-image-421-2.png\" alt=\"\" class=\"wp-image-423\"\/><\/figure>\n\n\n\n<h1 class=\"wp-block-heading\">SonarCloud and Azure Pipelines<\/h1>\n\n\n\n<p>We need to follow the below steps to scan our code with sonarcloud.io and Azure Pipelines.<\/p>\n\n\n\n<h2 class=\"wp-block-heading\">1. Installing Sonarcloud Extension in Azure DevOps<\/h2>\n\n\n\n<p>We need to go to the Azure DevOps marketplace and install the sonar cloud extension.<\/p>\n\n\n\n<figure class=\"wp-block-image\"><img decoding=\"async\" loading=\"lazy\" width=\"700\" height=\"349\" src=\"https:\/\/devopsinsiders.vehicleaider.com\/wp-content\/uploads\/2023\/01\/word-image-421-3.png\" alt=\"\" class=\"wp-image-424\"\/><\/figure>\n\n\n\n<p>In the marketplace, search for sonar cloud extension and click on \u201cGet it Free\u201d<\/p>\n\n\n\n<figure class=\"wp-block-image\"><img decoding=\"async\" loading=\"lazy\" width=\"700\" height=\"331\" src=\"https:\/\/devopsinsiders.vehicleaider.com\/wp-content\/uploads\/2023\/01\/word-image-421-4.png\" alt=\"\" class=\"wp-image-425\"\/><\/figure>\n\n\n\n<p>If you are the owner of the organization, then the extension will be installed but if you are not the owner of the organization then you will need the approval from the organization owner.<\/p>\n\n\n\n<h2 class=\"wp-block-heading\">2. Setting up a new project in Sonarcloud.io<\/h2>\n\n\n\n<p>Go to&nbsp;<a href=\"https:\/\/sonarcloud.io\/\" target=\"_blank\" rel=\"noopener\">https:\/\/sonarcloud.io<\/a>&nbsp;and create an account. Once the account is created, click the \u201cNew Project\u201d or \u201c+\u201d button on the Top Right Corner.<\/p>\n\n\n\n<figure class=\"wp-block-image\"><img decoding=\"async\" loading=\"lazy\" width=\"700\" height=\"105\" src=\"https:\/\/devopsinsiders.vehicleaider.com\/wp-content\/uploads\/2023\/01\/word-image-421-5.png\" alt=\"\" class=\"wp-image-426\"\/><\/figure>\n\n\n\n<p>Setup the new project by filling the required details.<\/p>\n\n\n\n<figure class=\"wp-block-image\"><img decoding=\"async\" loading=\"lazy\" width=\"636\" height=\"530\" src=\"https:\/\/devopsinsiders.vehicleaider.com\/wp-content\/uploads\/2023\/01\/word-image-421-6.png\" alt=\"\" class=\"wp-image-427\" srcset=\"http:\/\/localhost\/devopsinsiders\/wp-content\/uploads\/2023\/01\/word-image-421-6.png 636w, http:\/\/localhost\/devopsinsiders\/wp-content\/uploads\/2023\/01\/word-image-421-6-480x400.png 480w\" sizes=\"(max-width: 636px) 100vw, 636px\" \/><\/figure>\n\n\n\n<h2 class=\"wp-block-heading\">3. Generate a new Token in SonarCloud<\/h2>\n\n\n\n<p>Go to my account -&gt; Security Tab<\/p>\n\n\n\n<figure class=\"wp-block-image\"><img decoding=\"async\" loading=\"lazy\" width=\"550\" height=\"267\" src=\"https:\/\/devopsinsiders.vehicleaider.com\/wp-content\/uploads\/2023\/01\/word-image-421-7.png\" alt=\"\" class=\"wp-image-428\"\/><\/figure>\n\n\n\n<p>You will see the previously generated tokens and the option to generate a new token on this page.<\/p>\n\n\n\n<figure class=\"wp-block-image\"><img decoding=\"async\" loading=\"lazy\" width=\"659\" height=\"453\" src=\"https:\/\/devopsinsiders.vehicleaider.com\/wp-content\/uploads\/2023\/01\/word-image-421-8.png\" alt=\"\" class=\"wp-image-429\" srcset=\"http:\/\/localhost\/devopsinsiders\/wp-content\/uploads\/2023\/01\/word-image-421-8.png 659w, http:\/\/localhost\/devopsinsiders\/wp-content\/uploads\/2023\/01\/word-image-421-8-582x400.png 582w\" sizes=\"(max-width: 659px) 100vw, 659px\" \/><\/figure>\n\n\n\n<p>Just give any name to the new token and click on generate. A new token will be generated.<\/p>\n\n\n\n<p><em>Note: Make sure you copy the token as soon it is generated as you won\u2019t be able to see it again!<\/em><\/p>\n\n\n\n<p>Once the token is generated, We need to add a sonar cloud service Connection in Azure DevOps.<\/p>\n\n\n\n<h2 class=\"wp-block-heading\">4. Adding SonarCloud Service Connection in Azure DevOps<\/h2>\n\n\n\n<p>Go to project settings -&gt; Service Connections.<\/p>\n\n\n\n<figure class=\"wp-block-image\"><img decoding=\"async\" loading=\"lazy\" width=\"700\" height=\"322\" src=\"https:\/\/devopsinsiders.vehicleaider.com\/wp-content\/uploads\/2023\/01\/word-image-421-9.png\" alt=\"\" class=\"wp-image-430\"\/><\/figure>\n\n\n\n<p>In the service connections tab, Click on new Service Connection.<\/p>\n\n\n\n<figure class=\"wp-block-image\"><img decoding=\"async\" loading=\"lazy\" width=\"700\" height=\"320\" src=\"https:\/\/devopsinsiders.vehicleaider.com\/wp-content\/uploads\/2023\/01\/word-image-421-10.png\" alt=\"\" class=\"wp-image-431\"\/><\/figure>\n\n\n\n<p>Search for SonarCloud and click on Next.<\/p>\n\n\n\n<figure class=\"wp-block-image\"><img decoding=\"async\" loading=\"lazy\" width=\"483\" height=\"206\" src=\"https:\/\/devopsinsiders.vehicleaider.com\/wp-content\/uploads\/2023\/01\/word-image-421-11.png\" alt=\"\" class=\"wp-image-432\"\/><\/figure>\n\n\n\n<p>Paste the sonar cloud token and verify the connection.<\/p>\n\n\n\n<figure class=\"wp-block-image\"><img decoding=\"async\" loading=\"lazy\" width=\"483\" height=\"594\" src=\"https:\/\/devopsinsiders.vehicleaider.com\/wp-content\/uploads\/2023\/01\/word-image-421-12.png\" alt=\"\" class=\"wp-image-433\" srcset=\"http:\/\/localhost\/devopsinsiders\/wp-content\/uploads\/2023\/01\/word-image-421-12.png 483w, http:\/\/localhost\/devopsinsiders\/wp-content\/uploads\/2023\/01\/word-image-421-12-325x400.png 325w\" sizes=\"(max-width: 483px) 100vw, 483px\" \/><\/figure>\n\n\n\n<p>Once saved, You will see the service connection in the list.<\/p>\n\n\n\n<figure class=\"wp-block-image\"><img decoding=\"async\" loading=\"lazy\" width=\"498\" height=\"215\" src=\"https:\/\/devopsinsiders.vehicleaider.com\/wp-content\/uploads\/2023\/01\/word-image-421-13.png\" alt=\"\" class=\"wp-image-434\"\/><\/figure>\n\n\n\n<h2 class=\"wp-block-heading\">5. Adding Sonarcloud Scanner in Azure pipeline<\/h2>\n\n\n\n<p>Since we have installed the sonar cloud extension, Sonarcloud steps are searchable in the tasks.<\/p>\n\n\n\n<figure class=\"wp-block-image\"><img decoding=\"async\" loading=\"lazy\" width=\"700\" height=\"360\" src=\"https:\/\/devopsinsiders.vehicleaider.com\/wp-content\/uploads\/2023\/01\/word-image-421-14.png\" alt=\"\" class=\"wp-image-435\"\/><\/figure>\n\n\n\n<p>We will just add the Prepare analysis Configuration task before the build and Run Code analysis task after the build and then we will publish the Quality gate result.<\/p>\n\n\n\n<p><strong>Prepare Analysis Configuration:<\/strong><\/p>\n\n\n\n<figure class=\"wp-block-image\"><img decoding=\"async\" loading=\"lazy\" width=\"366\" height=\"439\" src=\"https:\/\/devopsinsiders.vehicleaider.com\/wp-content\/uploads\/2023\/01\/word-image-421-15.png\" alt=\"\" class=\"wp-image-436\" srcset=\"http:\/\/localhost\/devopsinsiders\/wp-content\/uploads\/2023\/01\/word-image-421-15.png 366w, http:\/\/localhost\/devopsinsiders\/wp-content\/uploads\/2023\/01\/word-image-421-15-333x400.png 333w\" sizes=\"(max-width: 366px) 100vw, 366px\" \/><\/figure>\n\n\n\n<p>Use the same SonarCloud Service Endpoint which was added in the Service Connections.<\/p>\n\n\n\n<p>Give the organization name of the SonarCloud account.<\/p>\n\n\n\n<p>We are scanning for the ReactJS app that why we are using the standalone scanner.<\/p>\n\n\n\n<figure class=\"wp-block-image\"><img decoding=\"async\" loading=\"lazy\" width=\"358\" height=\"500\" src=\"https:\/\/devopsinsiders.vehicleaider.com\/wp-content\/uploads\/2023\/01\/word-image-421-16.png\" alt=\"\" class=\"wp-image-437\" srcset=\"http:\/\/localhost\/devopsinsiders\/wp-content\/uploads\/2023\/01\/word-image-421-16.png 358w, http:\/\/localhost\/devopsinsiders\/wp-content\/uploads\/2023\/01\/word-image-421-16-286x400.png 286w\" sizes=\"(max-width: 358px) 100vw, 358px\" \/><\/figure>\n\n\n\n<p>We can provide the configuration in the sonar-project.properties file but here we are providing the manual configuration.<\/p>\n\n\n\n<p>Give the project key which was created in SonarCloud.<\/p>\n\n\n\n<p>We can use the BuildNumber variable of Azure Pipelines to version our SonarCloud analysis.<\/p>\n\n\n\n<p>In the Run Code Analysis and Publish Quality Gate results, We don&#8217;t need to do any configuration so just add the tasks in the YAML.<\/p>\n\n\n\n<p>Our final YAML will look like this.<\/p>\n\n\n\n<p># Node.js with React <br># Build a Node.js project that uses React. <br># Add steps that analyze code, save build artifacts, deploy, and more: <br># https:\/\/docs.microsoft.com\/azure\/devops\/pipelines\/languages\/javascript<\/p>\n\n\n\n<p>trigger: <br>&#8211; master<\/p>\n\n\n\n<p>pool: <br>default<\/p>\n\n\n\n<p>steps: <br>&#8211; task: NodeTool@0 <br>inputs: <br>versionSpec: &#8217;10.x&#8217; <br>displayName: &#8216;Install Node.js&#8217;<\/p>\n\n\n\n<p>&#8211; task: PowerShell@2 <br>inputs: <br>targetType: &#8216;inline&#8217; <br>script: &#8216;npm install&#8217;<\/p>\n\n\n\n<p>&#8211; task: SonarCloudPrepare@1 <br>inputs: <br>SonarCloud: &#8216;SonarCloud&#8217; <br>organization: &#8216;clouddevopstc&#8217; <br>scannerMode: &#8216;CLI&#8217; <br>configMode: &#8216;manual&#8217; <br>cliProjectKey: &#8216;demoquizapp&#8217; <br>cliProjectName: &#8216;Quiz App&#8217; <br>cliSources: &#8216;.&#8217;<\/p>\n\n\n\n<p>&#8211; task: PowerShell@2 <br>inputs: <br>targetType: &#8216;inline&#8217; <br>script: &#8216;npm run build.azure&#8217;<\/p>\n\n\n\n<p>&#8211; task: SonarCloudAnalyze@1<\/p>\n\n\n\n<p>&#8211; task: SonarCloudPublish@1 <br>inputs: <br>pollingTimeoutSec: &#8216;300&#8217; <br>displayName: &#8216;SonarCloud&#8217;<\/p>\n\n\n\n<p><strong>Once the Pipeline is ready, just click on Save and Run Pipeline.<\/strong><\/p>\n\n\n\n<p>The Pipeline steps will run and the analysis will be done on SonarCloud.<\/p>\n\n\n\n<figure class=\"wp-block-image\"><img decoding=\"async\" loading=\"lazy\" width=\"700\" height=\"298\" src=\"https:\/\/devopsinsiders.vehicleaider.com\/wp-content\/uploads\/2023\/01\/word-image-421-17.png\" alt=\"\" class=\"wp-image-438\"\/><\/figure>\n\n\n\n<p>Azure Pipeline Log<\/p>\n\n\n\n<p>We can also find the analysis results in the Extensions Tab in the Pipeline.<\/p>\n\n\n\n<figure class=\"wp-block-image\"><img decoding=\"async\" loading=\"lazy\" width=\"700\" height=\"256\" src=\"https:\/\/devopsinsiders.vehicleaider.com\/wp-content\/uploads\/2023\/01\/word-image-421-18.png\" alt=\"\" class=\"wp-image-439\"\/><\/figure>\n\n\n\n<p>If we click on \u201cDetailed SonarCloud Report\u201d, We will be redirected to the SonarCloud project. Here we can see the issues, Vulnerabilities, Security Hotspots, and other details of the code.<\/p>\n\n\n\n<p>You can view the analysis on&nbsp;<a href=\"https:\/\/sonarcloud.io\/dashboard?id=demoquizapp\" target=\"_blank\" rel=\"noopener\">https:\/\/sonarcloud.io\/dashboard?id=demoquizapp<\/a>.<\/p>\n\n\n\n<figure class=\"wp-block-image\"><img decoding=\"async\" loading=\"lazy\" width=\"700\" height=\"298\" src=\"https:\/\/devopsinsiders.vehicleaider.com\/wp-content\/uploads\/2023\/01\/word-image-421-19.png\" alt=\"\" class=\"wp-image-440\"\/><\/figure>\n\n\n\n<p>SonarCloud Analysis Page<\/p>\n\n\n\n<p><strong>Voila!! Our SonarCloud analysis has been done and We can get Project badges and add them to our README.MD file.<\/strong><\/p>\n\n\n\n<p>Conclusion: We discussed how to use sonarcloud for the Static Code Analysis of your code for Free! If you have any queries please write to me at 27aadesh@gmail.com, I will be happy to answer your questions.<\/p>\n\n\n\n\n<a class=\"wp-block-read-more\" href=\"http:\/\/localhost\/devopsinsiders\/static-code-analysis-with-sonarcloud-and-azure-pipelines\/\" target=\"_self\">Read more<span class=\"screen-reader-text\">: Static Code Analysis with SonarCloud and Azure Pipelines.<\/span><\/a>","protected":false},"excerpt":{"rendered":"<p>After setting up a CI Pipeline in the last blog, we are back with a new Blog. In the blog, I will tell you how you scan your code using SonarCloud for Free! Please read the previous blog for setting up a CI pipeline using Azure Pipelines:&nbsp; For this tutorial, we will use the following [&#8230;]\n","protected":false},"author":2,"featured_media":422,"comment_status":"open","ping_status":"open","sticky":false,"template":"","format":"standard","meta":[],"categories":[68],"tags":[],"_links":{"self":[{"href":"http:\/\/localhost\/devopsinsiders\/wp-json\/wp\/v2\/posts\/421"}],"collection":[{"href":"http:\/\/localhost\/devopsinsiders\/wp-json\/wp\/v2\/posts"}],"about":[{"href":"http:\/\/localhost\/devopsinsiders\/wp-json\/wp\/v2\/types\/post"}],"author":[{"embeddable":true,"href":"http:\/\/localhost\/devopsinsiders\/wp-json\/wp\/v2\/users\/2"}],"replies":[{"embeddable":true,"href":"http:\/\/localhost\/devopsinsiders\/wp-json\/wp\/v2\/comments?post=421"}],"version-history":[{"count":4,"href":"http:\/\/localhost\/devopsinsiders\/wp-json\/wp\/v2\/posts\/421\/revisions"}],"predecessor-version":[{"id":464,"href":"http:\/\/localhost\/devopsinsiders\/wp-json\/wp\/v2\/posts\/421\/revisions\/464"}],"wp:featuredmedia":[{"embeddable":true,"href":"http:\/\/localhost\/devopsinsiders\/wp-json\/wp\/v2\/media\/422"}],"wp:attachment":[{"href":"http:\/\/localhost\/devopsinsiders\/wp-json\/wp\/v2\/media?parent=421"}],"wp:term":[{"taxonomy":"category","embeddable":true,"href":"http:\/\/localhost\/devopsinsiders\/wp-json\/wp\/v2\/categories?post=421"},{"taxonomy":"post_tag","embeddable":true,"href":"http:\/\/localhost\/devopsinsiders\/wp-json\/wp\/v2\/tags?post=421"}],"curies":[{"name":"wp","href":"https:\/\/api.w.org\/{rel}","templated":true}]}}